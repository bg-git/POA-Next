{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["turbopack:///[turbopack]/browser/dev/hmr-client/hmr-client.ts"],"sourcesContent":["/// <reference path=\"../../../shared/runtime-types.d.ts\" />\r\n/// <reference path=\"../../runtime/base/dev-globals.d.ts\" />\r\n/// <reference path=\"../../runtime/base/dev-protocol.d.ts\" />\r\n/// <reference path=\"../../runtime/base/dev-extensions.ts\" />\r\n\r\ntype SendMessage = (msg: any) => void\r\nexport type WebSocketMessage =\r\n  | {\r\n      type: 'turbopack-connected'\r\n    }\r\n  | {\r\n      type: 'turbopack-message'\r\n      data: Record<string, any>\r\n    }\r\n\r\nexport type ClientOptions = {\r\n  addMessageListener: (cb: (msg: WebSocketMessage) => void) => void\r\n  sendMessage: SendMessage\r\n  onUpdateError: (err: unknown) => void\r\n}\r\n\r\nexport function connect({\r\n  addMessageListener,\r\n  sendMessage,\r\n  onUpdateError = console.error,\r\n}: ClientOptions) {\r\n  addMessageListener((msg) => {\r\n    switch (msg.type) {\r\n      case 'turbopack-connected':\r\n        handleSocketConnected(sendMessage)\r\n        break\r\n      default:\r\n        try {\r\n          if (Array.isArray(msg.data)) {\r\n            for (let i = 0; i < msg.data.length; i++) {\r\n              handleSocketMessage(msg.data[i] as ServerMessage)\r\n            }\r\n          } else {\r\n            handleSocketMessage(msg.data as ServerMessage)\r\n          }\r\n          applyAggregatedUpdates()\r\n        } catch (e: unknown) {\r\n          console.warn(\r\n            '[Fast Refresh] performing full reload\\n\\n' +\r\n              \"Fast Refresh will perform a full reload when you edit a file that's imported by modules outside of the React rendering tree.\\n\" +\r\n              'You might have a file which exports a React component but also exports a value that is imported by a non-React component file.\\n' +\r\n              'Consider migrating the non-React component export to a separate file and importing it into both files.\\n\\n' +\r\n              'It is also possible the parent component of the component you edited is a class component, which disables Fast Refresh.\\n' +\r\n              'Fast Refresh requires at least one parent function component in your React tree.'\r\n          )\r\n          onUpdateError(e)\r\n          location.reload()\r\n        }\r\n        break\r\n    }\r\n  })\r\n\r\n  const queued = globalThis.TURBOPACK_CHUNK_UPDATE_LISTENERS\r\n  if (queued != null && !Array.isArray(queued)) {\r\n    throw new Error('A separate HMR handler was already registered')\r\n  }\r\n  globalThis.TURBOPACK_CHUNK_UPDATE_LISTENERS = {\r\n    push: ([chunkPath, callback]: [ChunkListPath, UpdateCallback]) => {\r\n      subscribeToChunkUpdate(chunkPath, sendMessage, callback)\r\n    },\r\n  }\r\n\r\n  if (Array.isArray(queued)) {\r\n    for (const [chunkPath, callback] of queued) {\r\n      subscribeToChunkUpdate(chunkPath, sendMessage, callback)\r\n    }\r\n  }\r\n}\r\n\r\ntype UpdateCallbackSet = {\r\n  callbacks: Set<UpdateCallback>\r\n  unsubscribe: () => void\r\n}\r\n\r\nconst updateCallbackSets: Map<ResourceKey, UpdateCallbackSet> = new Map()\r\n\r\nfunction sendJSON(sendMessage: SendMessage, message: ClientMessage) {\r\n  sendMessage(JSON.stringify(message))\r\n}\r\n\r\ntype ResourceKey = string\r\n\r\nfunction resourceKey(resource: ResourceIdentifier): ResourceKey {\r\n  return JSON.stringify({\r\n    path: resource.path,\r\n    headers: resource.headers || null,\r\n  })\r\n}\r\n\r\nfunction subscribeToUpdates(\r\n  sendMessage: SendMessage,\r\n  resource: ResourceIdentifier\r\n): () => void {\r\n  sendJSON(sendMessage, {\r\n    type: 'turbopack-subscribe',\r\n    ...resource,\r\n  })\r\n\r\n  return () => {\r\n    sendJSON(sendMessage, {\r\n      type: 'turbopack-unsubscribe',\r\n      ...resource,\r\n    })\r\n  }\r\n}\r\n\r\nfunction handleSocketConnected(sendMessage: SendMessage) {\r\n  for (const key of updateCallbackSets.keys()) {\r\n    subscribeToUpdates(sendMessage, JSON.parse(key))\r\n  }\r\n}\r\n\r\n// we aggregate all pending updates until the issues are resolved\r\nconst chunkListsWithPendingUpdates: Map<ResourceKey, PartialServerMessage> =\r\n  new Map()\r\n\r\nfunction aggregateUpdates(msg: PartialServerMessage) {\r\n  const key = resourceKey(msg.resource)\r\n  let aggregated = chunkListsWithPendingUpdates.get(key)\r\n\r\n  if (aggregated) {\r\n    aggregated.instruction = mergeChunkListUpdates(\r\n      aggregated.instruction,\r\n      msg.instruction\r\n    )\r\n  } else {\r\n    chunkListsWithPendingUpdates.set(key, msg)\r\n  }\r\n}\r\n\r\nfunction applyAggregatedUpdates() {\r\n  if (chunkListsWithPendingUpdates.size === 0) return\r\n  hooks.beforeRefresh()\r\n  for (const msg of chunkListsWithPendingUpdates.values()) {\r\n    triggerUpdate(msg)\r\n  }\r\n  chunkListsWithPendingUpdates.clear()\r\n  finalizeUpdate()\r\n}\r\n\r\nfunction mergeChunkListUpdates(\r\n  updateA: ChunkListUpdate,\r\n  updateB: ChunkListUpdate\r\n): ChunkListUpdate {\r\n  let chunks\r\n  if (updateA.chunks != null) {\r\n    if (updateB.chunks == null) {\r\n      chunks = updateA.chunks\r\n    } else {\r\n      chunks = mergeChunkListChunks(updateA.chunks, updateB.chunks)\r\n    }\r\n  } else if (updateB.chunks != null) {\r\n    chunks = updateB.chunks\r\n  }\r\n\r\n  let merged\r\n  if (updateA.merged != null) {\r\n    if (updateB.merged == null) {\r\n      merged = updateA.merged\r\n    } else {\r\n      // Since `merged` is an array of updates, we need to merge them all into\r\n      // one, consistent update.\r\n      // Since there can only be `EcmascriptMergeUpdates` in the array, there is\r\n      // no need to key on the `type` field.\r\n      let update = updateA.merged[0]\r\n      for (let i = 1; i < updateA.merged.length; i++) {\r\n        update = mergeChunkListEcmascriptMergedUpdates(\r\n          update,\r\n          updateA.merged[i]\r\n        )\r\n      }\r\n\r\n      for (let i = 0; i < updateB.merged.length; i++) {\r\n        update = mergeChunkListEcmascriptMergedUpdates(\r\n          update,\r\n          updateB.merged[i]\r\n        )\r\n      }\r\n\r\n      merged = [update]\r\n    }\r\n  } else if (updateB.merged != null) {\r\n    merged = updateB.merged\r\n  }\r\n\r\n  return {\r\n    type: 'ChunkListUpdate',\r\n    chunks,\r\n    merged,\r\n  }\r\n}\r\n\r\nfunction mergeChunkListChunks(\r\n  chunksA: Record<ChunkPath, ChunkUpdate>,\r\n  chunksB: Record<ChunkPath, ChunkUpdate>\r\n): Record<ChunkPath, ChunkUpdate> {\r\n  const chunks: Record<ChunkPath, ChunkUpdate> = {}\r\n\r\n  for (const [chunkPath, chunkUpdateA] of Object.entries(chunksA) as Array<\r\n    [ChunkPath, ChunkUpdate]\r\n  >) {\r\n    const chunkUpdateB = chunksB[chunkPath]\r\n    if (chunkUpdateB != null) {\r\n      const mergedUpdate = mergeChunkUpdates(chunkUpdateA, chunkUpdateB)\r\n      if (mergedUpdate != null) {\r\n        chunks[chunkPath] = mergedUpdate\r\n      }\r\n    } else {\r\n      chunks[chunkPath] = chunkUpdateA\r\n    }\r\n  }\r\n\r\n  for (const [chunkPath, chunkUpdateB] of Object.entries(chunksB) as Array<\r\n    [ChunkPath, ChunkUpdate]\r\n  >) {\r\n    if (chunks[chunkPath] == null) {\r\n      chunks[chunkPath] = chunkUpdateB\r\n    }\r\n  }\r\n\r\n  return chunks\r\n}\r\n\r\nfunction mergeChunkUpdates(\r\n  updateA: ChunkUpdate,\r\n  updateB: ChunkUpdate\r\n): ChunkUpdate | undefined {\r\n  if (\r\n    (updateA.type === 'added' && updateB.type === 'deleted') ||\r\n    (updateA.type === 'deleted' && updateB.type === 'added')\r\n  ) {\r\n    return undefined\r\n  }\r\n\r\n  if (updateA.type === 'partial') {\r\n    invariant(updateA.instruction, 'Partial updates are unsupported')\r\n  }\r\n\r\n  if (updateB.type === 'partial') {\r\n    invariant(updateB.instruction, 'Partial updates are unsupported')\r\n  }\r\n\r\n  return undefined\r\n}\r\n\r\nfunction mergeChunkListEcmascriptMergedUpdates(\r\n  mergedA: EcmascriptMergedUpdate,\r\n  mergedB: EcmascriptMergedUpdate\r\n): EcmascriptMergedUpdate {\r\n  const entries = mergeEcmascriptChunkEntries(mergedA.entries, mergedB.entries)\r\n  const chunks = mergeEcmascriptChunksUpdates(mergedA.chunks, mergedB.chunks)\r\n\r\n  return {\r\n    type: 'EcmascriptMergedUpdate',\r\n    entries,\r\n    chunks,\r\n  }\r\n}\r\n\r\nfunction mergeEcmascriptChunkEntries(\r\n  entriesA: Record<ModuleId, EcmascriptModuleEntry> | undefined,\r\n  entriesB: Record<ModuleId, EcmascriptModuleEntry> | undefined\r\n): Record<ModuleId, EcmascriptModuleEntry> {\r\n  return { ...entriesA, ...entriesB }\r\n}\r\n\r\nfunction mergeEcmascriptChunksUpdates(\r\n  chunksA: Record<ChunkPath, EcmascriptMergedChunkUpdate> | undefined,\r\n  chunksB: Record<ChunkPath, EcmascriptMergedChunkUpdate> | undefined\r\n): Record<ChunkPath, EcmascriptMergedChunkUpdate> | undefined {\r\n  if (chunksA == null) {\r\n    return chunksB\r\n  }\r\n\r\n  if (chunksB == null) {\r\n    return chunksA\r\n  }\r\n\r\n  const chunks: Record<ChunkPath, EcmascriptMergedChunkUpdate> = {}\r\n\r\n  for (const [chunkPath, chunkUpdateA] of Object.entries(chunksA) as Array<\r\n    [ChunkPath, EcmascriptMergedChunkUpdate]\r\n  >) {\r\n    const chunkUpdateB = chunksB[chunkPath]\r\n    if (chunkUpdateB != null) {\r\n      const mergedUpdate = mergeEcmascriptChunkUpdates(\r\n        chunkUpdateA,\r\n        chunkUpdateB\r\n      )\r\n      if (mergedUpdate != null) {\r\n        chunks[chunkPath] = mergedUpdate\r\n      }\r\n    } else {\r\n      chunks[chunkPath] = chunkUpdateA\r\n    }\r\n  }\r\n\r\n  for (const [chunkPath, chunkUpdateB] of Object.entries(chunksB) as Array<\r\n    [ChunkPath, EcmascriptMergedChunkUpdate]\r\n  >) {\r\n    if (chunks[chunkPath] == null) {\r\n      chunks[chunkPath] = chunkUpdateB\r\n    }\r\n  }\r\n\r\n  if (Object.keys(chunks).length === 0) {\r\n    return undefined\r\n  }\r\n\r\n  return chunks\r\n}\r\n\r\nfunction mergeEcmascriptChunkUpdates(\r\n  updateA: EcmascriptMergedChunkUpdate,\r\n  updateB: EcmascriptMergedChunkUpdate\r\n): EcmascriptMergedChunkUpdate | undefined {\r\n  if (updateA.type === 'added' && updateB.type === 'deleted') {\r\n    // These two completely cancel each other out.\r\n    return undefined\r\n  }\r\n\r\n  if (updateA.type === 'deleted' && updateB.type === 'added') {\r\n    const added = []\r\n    const deleted = []\r\n    const deletedModules = new Set(updateA.modules ?? [])\r\n    const addedModules = new Set(updateB.modules ?? [])\r\n\r\n    for (const moduleId of addedModules) {\r\n      if (!deletedModules.has(moduleId)) {\r\n        added.push(moduleId)\r\n      }\r\n    }\r\n\r\n    for (const moduleId of deletedModules) {\r\n      if (!addedModules.has(moduleId)) {\r\n        deleted.push(moduleId)\r\n      }\r\n    }\r\n\r\n    if (added.length === 0 && deleted.length === 0) {\r\n      return undefined\r\n    }\r\n\r\n    return {\r\n      type: 'partial',\r\n      added,\r\n      deleted,\r\n    }\r\n  }\r\n\r\n  if (updateA.type === 'partial' && updateB.type === 'partial') {\r\n    const added = new Set([...(updateA.added ?? []), ...(updateB.added ?? [])])\r\n    const deleted = new Set([\r\n      ...(updateA.deleted ?? []),\r\n      ...(updateB.deleted ?? []),\r\n    ])\r\n\r\n    if (updateB.added != null) {\r\n      for (const moduleId of updateB.added) {\r\n        deleted.delete(moduleId)\r\n      }\r\n    }\r\n\r\n    if (updateB.deleted != null) {\r\n      for (const moduleId of updateB.deleted) {\r\n        added.delete(moduleId)\r\n      }\r\n    }\r\n\r\n    return {\r\n      type: 'partial',\r\n      added: [...added],\r\n      deleted: [...deleted],\r\n    }\r\n  }\r\n\r\n  if (updateA.type === 'added' && updateB.type === 'partial') {\r\n    const modules = new Set([\r\n      ...(updateA.modules ?? []),\r\n      ...(updateB.added ?? []),\r\n    ])\r\n\r\n    for (const moduleId of updateB.deleted ?? []) {\r\n      modules.delete(moduleId)\r\n    }\r\n\r\n    return {\r\n      type: 'added',\r\n      modules: [...modules],\r\n    }\r\n  }\r\n\r\n  if (updateA.type === 'partial' && updateB.type === 'deleted') {\r\n    // We could eagerly return `updateB` here, but this would potentially be\r\n    // incorrect if `updateA` has added modules.\r\n\r\n    const modules = new Set(updateB.modules ?? [])\r\n\r\n    if (updateA.added != null) {\r\n      for (const moduleId of updateA.added) {\r\n        modules.delete(moduleId)\r\n      }\r\n    }\r\n\r\n    return {\r\n      type: 'deleted',\r\n      modules: [...modules],\r\n    }\r\n  }\r\n\r\n  // Any other update combination is invalid.\r\n\r\n  return undefined\r\n}\r\n\r\nfunction invariant(_: never, message: string): never {\r\n  throw new Error(`Invariant: ${message}`)\r\n}\r\n\r\nconst CRITICAL = ['bug', 'error', 'fatal']\r\n\r\nfunction compareByList(list: any[], a: any, b: any) {\r\n  const aI = list.indexOf(a) + 1 || list.length\r\n  const bI = list.indexOf(b) + 1 || list.length\r\n  return aI - bI\r\n}\r\n\r\nconst chunksWithIssues: Map<ResourceKey, Issue[]> = new Map()\r\n\r\nfunction emitIssues() {\r\n  const issues = []\r\n  const deduplicationSet = new Set()\r\n\r\n  for (const [_, chunkIssues] of chunksWithIssues) {\r\n    for (const chunkIssue of chunkIssues) {\r\n      if (deduplicationSet.has(chunkIssue.formatted)) continue\r\n\r\n      issues.push(chunkIssue)\r\n      deduplicationSet.add(chunkIssue.formatted)\r\n    }\r\n  }\r\n\r\n  sortIssues(issues)\r\n\r\n  hooks.issues(issues)\r\n}\r\n\r\nfunction handleIssues(msg: ServerMessage): boolean {\r\n  const key = resourceKey(msg.resource)\r\n  let hasCriticalIssues = false\r\n\r\n  for (const issue of msg.issues) {\r\n    if (CRITICAL.includes(issue.severity)) {\r\n      hasCriticalIssues = true\r\n    }\r\n  }\r\n\r\n  if (msg.issues.length > 0) {\r\n    chunksWithIssues.set(key, msg.issues)\r\n  } else if (chunksWithIssues.has(key)) {\r\n    chunksWithIssues.delete(key)\r\n  }\r\n\r\n  emitIssues()\r\n\r\n  return hasCriticalIssues\r\n}\r\n\r\nconst SEVERITY_ORDER = ['bug', 'fatal', 'error', 'warning', 'info', 'log']\r\nconst CATEGORY_ORDER = [\r\n  'parse',\r\n  'resolve',\r\n  'code generation',\r\n  'rendering',\r\n  'typescript',\r\n  'other',\r\n]\r\n\r\nfunction sortIssues(issues: Issue[]) {\r\n  issues.sort((a, b) => {\r\n    const first = compareByList(SEVERITY_ORDER, a.severity, b.severity)\r\n    if (first !== 0) return first\r\n    return compareByList(CATEGORY_ORDER, a.category, b.category)\r\n  })\r\n}\r\n\r\nconst hooks = {\r\n  beforeRefresh: () => {},\r\n  refresh: () => {},\r\n  buildOk: () => {},\r\n  issues: (_issues: Issue[]) => {},\r\n}\r\n\r\nexport function setHooks(newHooks: typeof hooks) {\r\n  Object.assign(hooks, newHooks)\r\n}\r\n\r\nfunction handleSocketMessage(msg: ServerMessage) {\r\n  sortIssues(msg.issues)\r\n\r\n  handleIssues(msg)\r\n\r\n  switch (msg.type) {\r\n    case 'issues':\r\n      // issues are already handled\r\n      break\r\n    case 'partial':\r\n      // aggregate updates\r\n      aggregateUpdates(msg)\r\n      break\r\n    default:\r\n      // run single update\r\n      const runHooks = chunkListsWithPendingUpdates.size === 0\r\n      if (runHooks) hooks.beforeRefresh()\r\n      triggerUpdate(msg)\r\n      if (runHooks) finalizeUpdate()\r\n      break\r\n  }\r\n}\r\n\r\nfunction finalizeUpdate() {\r\n  hooks.refresh()\r\n  hooks.buildOk()\r\n\r\n  // This is used by the Next.js integration test suite to notify it when HMR\r\n  // updates have been completed.\r\n  // TODO: Only run this in test environments (gate by `process.env.__NEXT_TEST_MODE`)\r\n  if (globalThis.__NEXT_HMR_CB) {\r\n    globalThis.__NEXT_HMR_CB()\r\n    globalThis.__NEXT_HMR_CB = null\r\n  }\r\n}\r\n\r\nfunction subscribeToChunkUpdate(\r\n  chunkListPath: ChunkListPath,\r\n  sendMessage: SendMessage,\r\n  callback: UpdateCallback\r\n): () => void {\r\n  return subscribeToUpdate(\r\n    {\r\n      path: chunkListPath,\r\n    },\r\n    sendMessage,\r\n    callback\r\n  )\r\n}\r\n\r\nexport function subscribeToUpdate(\r\n  resource: ResourceIdentifier,\r\n  sendMessage: SendMessage,\r\n  callback: UpdateCallback\r\n) {\r\n  const key = resourceKey(resource)\r\n  let callbackSet: UpdateCallbackSet\r\n  const existingCallbackSet = updateCallbackSets.get(key)\r\n  if (!existingCallbackSet) {\r\n    callbackSet = {\r\n      callbacks: new Set([callback]),\r\n      unsubscribe: subscribeToUpdates(sendMessage, resource),\r\n    }\r\n    updateCallbackSets.set(key, callbackSet)\r\n  } else {\r\n    existingCallbackSet.callbacks.add(callback)\r\n    callbackSet = existingCallbackSet\r\n  }\r\n\r\n  return () => {\r\n    callbackSet.callbacks.delete(callback)\r\n\r\n    if (callbackSet.callbacks.size === 0) {\r\n      callbackSet.unsubscribe()\r\n      updateCallbackSets.delete(key)\r\n    }\r\n  }\r\n}\r\n\r\nfunction triggerUpdate(msg: ServerMessage) {\r\n  const key = resourceKey(msg.resource)\r\n  const callbackSet = updateCallbackSets.get(key)\r\n  if (!callbackSet) {\r\n    return\r\n  }\r\n\r\n  for (const callback of callbackSet.callbacks) {\r\n    callback(msg)\r\n  }\r\n\r\n  if (msg.type === 'notFound') {\r\n    // This indicates that the resource which we subscribed to either does not exist or\r\n    // has been deleted. In either case, we should clear all update callbacks, so if a\r\n    // new subscription is created for the same resource, it will send a new \"subscribe\"\r\n    // message to the server.\r\n    // No need to send an \"unsubscribe\" message to the server, it will have already\r\n    // dropped the update stream before sending the \"notFound\" message.\r\n    updateCallbackSets.delete(key)\r\n  }\r\n}\r\n"],"names":[],"mappings":"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","ignoreList":[0]}},
    {"offset": {"line": 469, "column": 0}, "map": {"version":3,"sources":["file:///C:/POA%20Next/apps/storefront/src/lib/cookies.ts"],"sourcesContent":["export const COOKIE_NAME = 'customer_session';\r\nexport const COOKIE_MAX_AGE = 60 * 60 * 24 * 30; // 30 days in seconds\r\nconst COOKIE_DOMAIN =\r\n  process.env.NEXT_PUBLIC_AUTH_COOKIE_DOMAIN || '.pierceofart.co.uk';\r\n\r\nexport function setCustomerCookie(res: any, token: string) {\r\n  const expires = new Date(Date.now() + COOKIE_MAX_AGE * 1000);\r\n  const cookie = `${COOKIE_NAME}=${encodeURIComponent(\r\n    token,\r\n  )}; Path=/; SameSite=None; Max-Age=${COOKIE_MAX_AGE}; Expires=${expires.toUTCString()}; Domain=${COOKIE_DOMAIN}; Secure`;\r\n  res.setHeader('Set-Cookie', cookie);\r\n}\r\n\r\nexport function clearCustomerCookie(res: any) {\r\n  const cookie = `${COOKIE_NAME}=; Path=/; SameSite=None; Max-Age=0; Domain=${COOKIE_DOMAIN}; Secure`;\r\n  res.setHeader('Set-Cookie', cookie);\r\n}\r\n"],"names":[],"mappings":";;;;;;;;;;AAGE;AAHK,MAAM,cAAc;AACpB,MAAM,iBAAiB,KAAK,KAAK,KAAK,IAAI,qBAAqB;AACtE,MAAM,gBACJ,oKAAO,CAAC,GAAG,CAAC,8BAA8B,IAAI;AAEzC,SAAS,kBAAkB,GAAQ,EAAE,KAAa;IACvD,MAAM,UAAU,IAAI,KAAK,KAAK,GAAG,KAAK,iBAAiB;IACvD,MAAM,SAAS,GAAG,YAAY,CAAC,EAAE,mBAC/B,OACA,iCAAiC,EAAE,eAAe,UAAU,EAAE,QAAQ,WAAW,GAAG,SAAS,EAAE,cAAc,QAAQ,CAAC;IACxH,IAAI,SAAS,CAAC,cAAc;AAC9B;AAEO,SAAS,oBAAoB,GAAQ;IAC1C,MAAM,SAAS,GAAG,YAAY,4CAA4C,EAAE,cAAc,QAAQ,CAAC;IACnG,IAAI,SAAS,CAAC,cAAc;AAC9B"}},
    {"offset": {"line": 499, "column": 0}, "map": {"version":3,"sources":["file:///C:/POA%20Next/apps/storefront/src/context/AuthContext.tsx"],"sourcesContent":["import {\r\n  createContext,\r\n  useContext,\r\n  useState,\r\n  useEffect,\r\n  ReactNode,\r\n} from 'react';\r\nimport { useRouter } from 'next/router';\r\nimport { COOKIE_NAME, COOKIE_MAX_AGE } from '@/lib/cookies';\r\n\r\nconst STORAGE_KEY = 'poa-auth-user';\r\n\r\ntype Debounced<T extends (...args: unknown[]) => void> = ((...args: Parameters<T>) => void) & {\r\n  cancel: () => void;\r\n};\r\n\r\nfunction debounce<T extends (...args: unknown[]) => void>(\r\n  fn: T,\r\n  delay: number,\r\n): Debounced<T> {\r\n  let timeoutId: ReturnType<typeof setTimeout> | null = null;\r\n  const debounced = (...args: Parameters<T>) => {\r\n    if (timeoutId) {\r\n      clearTimeout(timeoutId);\r\n    }\r\n    timeoutId = setTimeout(() => fn(...args), delay);\r\n  };\r\n  debounced.cancel = () => {\r\n    if (timeoutId) {\r\n      clearTimeout(timeoutId);\r\n      timeoutId = null;\r\n    }\r\n  };\r\n  return debounced;\r\n}\r\n\r\nexport interface ShopifyCustomer {\r\n  id: string;\r\n  email: string;\r\n  firstName?: string;\r\n  lastName?: string;\r\n  tags?: string[];\r\n  defaultAddress?: {\r\n    country?: string;\r\n    [key: string]: unknown;\r\n  };\r\n  [key: string]: unknown;\r\n}\r\n\r\ninterface AuthContextType {\r\n  isAuthenticated: boolean;\r\n  user: ShopifyCustomer | null;\r\n  signIn: (email: string, password: string) => Promise<{ success: boolean; error?: string }>;\r\n  signOut: () => void;\r\n  loading: boolean;\r\n  refreshUser: () => Promise<void>;\r\n}\r\n\r\nconst AuthContext = createContext<AuthContextType | undefined>(undefined);\r\n\r\ninterface AuthProviderProps {\r\n  children: ReactNode;\r\n  initialUser?: ShopifyCustomer | null;\r\n}\r\n\r\nfunction getInitialAuth(initialUser?: ShopifyCustomer | null) {\r\n  if (initialUser) {\r\n    return { user: initialUser, isAuthenticated: true };\r\n  }\r\n\r\n  if (typeof window !== 'undefined') {\r\n    try {\r\n      const stored = localStorage.getItem(STORAGE_KEY);\r\n      if (stored) {\r\n        return { user: JSON.parse(stored) as ShopifyCustomer, isAuthenticated: true };\r\n      }\r\n    } catch {\r\n      // ignore parse errors\r\n    }\r\n\r\n    const hasCookie = document.cookie\r\n      .split('; ')\r\n      .some((cookie) => cookie.startsWith(`${COOKIE_NAME}=`));\r\n\r\n    if (hasCookie) {\r\n      return { user: null, isAuthenticated: true };\r\n    }\r\n  }\r\n\r\n  return { user: null, isAuthenticated: false };\r\n}\r\n\r\nexport function AuthProvider({ children, initialUser }: AuthProviderProps) {\r\n  const { user: initialStateUser, isAuthenticated: initialAuth } =\r\n    getInitialAuth(initialUser);\r\n  const [user, setUser] = useState<ShopifyCustomer | null>(initialStateUser);\r\n  const [isAuthenticated, setIsAuthenticated] = useState(initialAuth);\r\n  const [loading] = useState(false);\r\n  const router = useRouter();\r\n\r\n  const verifySession = async (): Promise<boolean> => {\r\n    const hasCookie = document.cookie\r\n      .split('; ')\r\n      .some((cookie) => cookie.startsWith(`${COOKIE_NAME}=`));\r\n\r\n    if (!hasCookie) {\r\n      setUser(null);\r\n      setIsAuthenticated(false);\r\n      if (typeof window !== 'undefined') {\r\n        localStorage.removeItem(STORAGE_KEY);\r\n      }\r\n      return false;\r\n    }\r\n\r\n    try {\r\n      const res = await fetch('/api/shopify/verify-customer', {\r\n        method: 'POST',\r\n        headers: { 'Content-Type': 'application/json' },\r\n        credentials: 'include',\r\n      });\r\n\r\n      if (res.ok) {\r\n        const data = await res.json();\r\n        setUser(data.customer);\r\n        setIsAuthenticated(true);\r\n        if (typeof window !== 'undefined') {\r\n          localStorage.setItem(STORAGE_KEY, JSON.stringify(data.customer));\r\n        }\r\n        return true;\r\n      } else {\r\n        setUser(null);\r\n        setIsAuthenticated(false);\r\n        if (typeof window !== 'undefined') {\r\n          localStorage.removeItem(STORAGE_KEY);\r\n        }\r\n        return false;\r\n      }\r\n    } catch (error) {\r\n      console.error('Auth check failed:', error);\r\n      setUser(null);\r\n      setIsAuthenticated(false);\r\n      if (typeof window !== 'undefined') {\r\n        localStorage.removeItem(STORAGE_KEY);\r\n      }\r\n      return false;\r\n    }\r\n  };\r\n\r\n  useEffect(() => {\r\n    verifySession();\r\n\r\n    let intervalId: ReturnType<typeof setInterval> | null = null;\r\n\r\n    const startInterval = () => {\r\n      if (intervalId === null) {\r\n        intervalId = setInterval(verifySession, 60_000);\r\n      }\r\n    };\r\n\r\n    const stopInterval = () => {\r\n      if (intervalId !== null) {\r\n        clearInterval(intervalId);\r\n        intervalId = null;\r\n      }\r\n    };\r\n\r\n    if (document.visibilityState === 'visible') {\r\n      startInterval();\r\n    }\r\n\r\n    const debouncedVerifySession = debounce(verifySession, 1_000);\r\n\r\n    const handleVisibilityChange = () => {\r\n      if (document.visibilityState === 'visible') {\r\n        debouncedVerifySession();\r\n        startInterval();\r\n      } else {\r\n        debouncedVerifySession.cancel();\r\n        stopInterval();\r\n      }\r\n    };\r\n\r\n    document.addEventListener('visibilitychange', handleVisibilityChange);\r\n\r\n    return () => {\r\n      stopInterval();\r\n      document.removeEventListener('visibilitychange', handleVisibilityChange);\r\n      debouncedVerifySession.cancel();\r\n    };\r\n  }, []);\r\n\r\n\r\n  const signIn = async (email: string, password: string) => {\r\n    try {\r\n      const response = await fetch('/api/shopify/sign-in-customer', {\r\n        method: 'POST',\r\n        headers: { 'Content-Type': 'application/json' },\r\n        body: JSON.stringify({ email, password }),\r\n        credentials: 'include',\r\n      });\r\n\r\n      const data = await response.json();\r\n\r\n      if (response.ok && data.success) {\r\n        setIsAuthenticated(true);\r\n\r\n        const domain =\r\n          process.env.NEXT_PUBLIC_AUTH_COOKIE_DOMAIN || window.location.hostname;\r\n        document.cookie = `${COOKIE_NAME}=${encodeURIComponent(\r\n          data.accessToken,\r\n        )}; Domain=${domain}; Path=/; Secure; SameSite=None; Max-Age=${COOKIE_MAX_AGE}`;\r\n\r\n        // Fetch user data\r\n        const userResponse = await fetch('/api/shopify/get-customer', {\r\n          method: 'POST',\r\n          headers: { 'Content-Type': 'application/json' },\r\n          credentials: 'include',\r\n        });\r\n\r\n        if (userResponse.ok) {\r\n          const userData = await userResponse.json();\r\n          setUser(userData.customer);\r\n          if (typeof window !== 'undefined') {\r\n            localStorage.setItem(\r\n              STORAGE_KEY,\r\n              JSON.stringify(userData.customer),\r\n            );\r\n          }\r\n        }\r\n\r\n        // Verify session after sign in\r\n        const verified = await verifySession();\r\n        if (verified) {\r\n          return { success: true };\r\n        }\r\n        return { success: false, error: 'Session verification failed' };\r\n      } else {\r\n        return { success: false, error: data.error || 'Sign in failed' };\r\n      }\r\n    } catch {\r\n      return { success: false, error: 'Network error' };\r\n    }\r\n  };\r\n\r\n  const signOut = async () => {\r\n    await fetch('/api/shopify/logout', { method: 'POST', credentials: 'include' });\r\n\r\n    const domain =\r\n      process.env.NEXT_PUBLIC_AUTH_COOKIE_DOMAIN || window.location.hostname;\r\n    document.cookie = `${COOKIE_NAME}=; Domain=${domain}; Path=/; Secure; SameSite=None; Max-Age=0`;\r\n\r\n    setIsAuthenticated(false);\r\n    setUser(null);\r\n    if (typeof window !== 'undefined') {\r\n      localStorage.removeItem(STORAGE_KEY);\r\n    }\r\n    router.push('/');\r\n  };\r\n\r\n  const refreshUser = async () => {\r\n    try {\r\n      const res = await fetch('/api/shopify/get-customer', {\r\n        method: 'POST',\r\n        headers: { 'Content-Type': 'application/json' },\r\n        credentials: 'include',\r\n      });\r\n\r\n      if (res.ok) {\r\n        const data = await res.json();\r\n        setUser(data.customer);\r\n        if (typeof window !== 'undefined') {\r\n          localStorage.setItem(STORAGE_KEY, JSON.stringify(data.customer));\r\n        }\r\n      }\r\n    } catch (err) {\r\n      console.error('Failed to refresh user:', err);\r\n    }\r\n  };\r\n\r\n  return (\r\n    <AuthContext.Provider\r\n      value={{ isAuthenticated, user, signIn, signOut, loading, refreshUser }}\r\n    >\r\n      {children}\r\n    </AuthContext.Provider>\r\n  );\r\n}\r\n\r\nexport function useAuth() {\r\n  const context = useContext(AuthContext);\r\n  if (context === undefined) {\r\n    throw new Error('useAuth must be used within an AuthProvider');\r\n  }\r\n  return context;\r\n}\r\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 795, "column": 0}, "map": {"version":3,"sources":["file:///C:/POA%20Next/apps/storefront/src/components/BookingAuthModal.tsx"],"sourcesContent":["import React, { useState } from 'react';\r\nimport { useAuth } from '@/context/AuthContext';\r\n\r\ntype BookingAuthModalProps = {\r\n  isOpen: boolean;\r\n  onClose: () => void;\r\n  onAuthSuccess: () => void;\r\n};\r\n\r\nconst BookingAuthModal: React.FC<BookingAuthModalProps> = ({\r\n  isOpen,\r\n  onClose,\r\n  onAuthSuccess,\r\n}) => {\r\n  const { signIn } = useAuth();\r\n  const [mode, setMode] = useState<'choose' | 'signin' | 'register'>('choose');\r\n  const [email, setEmail] = useState('');\r\n  const [password, setPassword] = useState('');\r\n  const [loading, setLoading] = useState(false);\r\n  const [error, setError] = useState('');\r\n\r\n  if (!isOpen) return null;\r\n\r\n  const handleSignIn = async (e: React.FormEvent) => {\r\n    e.preventDefault();\r\n    setError('');\r\n    setLoading(true);\r\n\r\n    try {\r\n      const result = await signIn(email, password);\r\n      if (result.success) {\r\n        setEmail('');\r\n        setPassword('');\r\n        setMode('choose');\r\n        onClose();\r\n        onAuthSuccess();\r\n      } else {\r\n        setError(result.error || 'Sign in failed');\r\n      }\r\n    } catch {\r\n      setError('An error occurred. Please try again.');\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  const handleRegisterClick = () => {\r\n    // Open register page in a new tab or modal - for now redirect\r\n    window.open('/account?tab=register', '_blank');\r\n  };\r\n\r\n  return (\r\n    <div style={{\r\n      position: 'fixed',\r\n      top: 0,\r\n      left: 0,\r\n      right: 0,\r\n      bottom: 0,\r\n      background: 'rgba(0, 0, 0, 0.5)',\r\n      display: 'flex',\r\n      alignItems: 'center',\r\n      justifyContent: 'center',\r\n      zIndex: 1000,\r\n    }}>\r\n      <div style={{\r\n        background: '#fff',\r\n        padding: '40px 32px',\r\n        borderRadius: '0',\r\n        maxWidth: '500px',\r\n        width: '90%',\r\n        position: 'relative',\r\n      }}>\r\n        <button\r\n          type=\"button\"\r\n          aria-label=\"Close\"\r\n          onClick={onClose}\r\n          style={{\r\n            position: 'absolute',\r\n            top: '16px',\r\n            right: '16px',\r\n            background: 'none',\r\n            border: 'none',\r\n            fontSize: '28px',\r\n            cursor: 'pointer',\r\n            color: '#000',\r\n            padding: '0',\r\n            width: '40px',\r\n            height: '40px',\r\n            display: 'flex',\r\n            alignItems: 'center',\r\n            justifyContent: 'center',\r\n          }}\r\n        >\r\n          ×\r\n        </button>\r\n\r\n        {mode === 'choose' && (\r\n          <>\r\n            <h2 style={{\r\n              fontSize: '24px',\r\n              fontWeight: '700',\r\n              marginBottom: '12px',\r\n              textTransform: 'uppercase',\r\n              margin: '0 0 12px 0',\r\n            }}>\r\n              SIGN IN TO BOOK\r\n            </h2>\r\n\r\n            <p style={{\r\n              fontSize: '14px',\r\n              color: '#666',\r\n              marginBottom: '32px',\r\n              margin: '0 0 32px 0',\r\n            }}>\r\n              You need to be logged in to book an appointment. Sign in to your account or create a new one.\r\n            </p>\r\n\r\n            <div style={{\r\n              display: 'flex',\r\n              flexDirection: 'column',\r\n              gap: '12px',\r\n            }}>\r\n              <button\r\n                type=\"button\"\r\n                onClick={() => setMode('signin')}\r\n                style={{\r\n                  padding: '16px 24px',\r\n                  fontSize: '16px',\r\n                  fontWeight: '600',\r\n                  background: '#000',\r\n                  color: '#fff',\r\n                  border: 'none',\r\n                  borderRadius: '0',\r\n                  cursor: 'pointer',\r\n                  textTransform: 'uppercase',\r\n                  width: '100%',\r\n                }}\r\n              >\r\n                Sign In\r\n              </button>\r\n\r\n              <button\r\n                type=\"button\"\r\n                onClick={handleRegisterClick}\r\n                style={{\r\n                  padding: '16px 24px',\r\n                  fontSize: '16px',\r\n                  fontWeight: '600',\r\n                  background: '#fff',\r\n                  color: '#000',\r\n                  border: '1px solid #000',\r\n                  borderRadius: '0',\r\n                  cursor: 'pointer',\r\n                  textTransform: 'uppercase',\r\n                  width: '100%',\r\n                }}\r\n              >\r\n                Create Account\r\n              </button>\r\n            </div>\r\n\r\n            <p style={{\r\n              fontSize: '12px',\r\n              color: '#999',\r\n              marginTop: '24px',\r\n              textAlign: 'center',\r\n              margin: '24px 0 0 0',\r\n            }}>\r\n              Your booking will be saved to your account and a draft order will be created in Shopify.\r\n            </p>\r\n          </>\r\n        )}\r\n\r\n        {mode === 'signin' && (\r\n          <>\r\n            <h2 style={{\r\n              fontSize: '24px',\r\n              fontWeight: '700',\r\n              marginBottom: '24px',\r\n              textTransform: 'uppercase',\r\n              margin: '0 0 24px 0',\r\n            }}>\r\n              SIGN IN\r\n            </h2>\r\n\r\n            <form onSubmit={handleSignIn} style={{ display: 'flex', flexDirection: 'column', gap: '16px' }}>\r\n              <div>\r\n                <label style={{\r\n                  display: 'block',\r\n                  fontSize: '14px',\r\n                  fontWeight: '600',\r\n                  marginBottom: '8px',\r\n                  textTransform: 'uppercase',\r\n                }}>\r\n                  Email\r\n                </label>\r\n                <input\r\n                  type=\"email\"\r\n                  value={email}\r\n                  onChange={(e) => setEmail(e.target.value)}\r\n                  required\r\n                  style={{\r\n                    width: '100%',\r\n                    padding: '12px',\r\n                    fontSize: '14px',\r\n                    border: '1px solid #ddd',\r\n                    borderRadius: '0',\r\n                    boxSizing: 'border-box',\r\n                    fontFamily: 'inherit',\r\n                  }}\r\n                  placeholder=\"your@email.com\"\r\n                />\r\n              </div>\r\n\r\n              <div>\r\n                <label style={{\r\n                  display: 'block',\r\n                  fontSize: '14px',\r\n                  fontWeight: '600',\r\n                  marginBottom: '8px',\r\n                  textTransform: 'uppercase',\r\n                }}>\r\n                  Password\r\n                </label>\r\n                <input\r\n                  type=\"password\"\r\n                  value={password}\r\n                  onChange={(e) => setPassword(e.target.value)}\r\n                  required\r\n                  style={{\r\n                    width: '100%',\r\n                    padding: '12px',\r\n                    fontSize: '14px',\r\n                    border: '1px solid #ddd',\r\n                    borderRadius: '0',\r\n                    boxSizing: 'border-box',\r\n                    fontFamily: 'inherit',\r\n                  }}\r\n                  placeholder=\"••••••••\"\r\n                />\r\n              </div>\r\n\r\n              {error && (\r\n                <div style={{\r\n                  padding: '12px',\r\n                  background: '#fee',\r\n                  color: '#c00',\r\n                  fontSize: '13px',\r\n                  borderRadius: '0',\r\n                }}>\r\n                  {error}\r\n                </div>\r\n              )}\r\n\r\n              <button\r\n                type=\"submit\"\r\n                disabled={loading}\r\n                style={{\r\n                  padding: '16px 24px',\r\n                  fontSize: '16px',\r\n                  fontWeight: '700',\r\n                  background: '#000',\r\n                  color: '#fff',\r\n                  border: 'none',\r\n                  borderRadius: '0',\r\n                  cursor: loading ? 'not-allowed' : 'pointer',\r\n                  textTransform: 'uppercase',\r\n                  width: '100%',\r\n                  opacity: loading ? 0.7 : 1,\r\n                }}\r\n              >\r\n                {loading ? 'Signing In...' : 'Sign In'}\r\n              </button>\r\n            </form>\r\n\r\n            <button\r\n              type=\"button\"\r\n              onClick={() => setMode('choose')}\r\n              style={{\r\n                marginTop: '16px',\r\n                padding: '12px 24px',\r\n                background: 'none',\r\n                border: 'none',\r\n                color: '#666',\r\n                cursor: 'pointer',\r\n                fontSize: '14px',\r\n                width: '100%',\r\n              }}\r\n            >\r\n              ← Back\r\n            </button>\r\n          </>\r\n        )}\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default BookingAuthModal;\r\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 1189, "column": 0}, "map": {"version":3,"sources":["file:///C:/POA%20Next/apps/storefront/src/pages/book-a-piercing/%5Blocation%5D.tsx"],"sourcesContent":["import Head from 'next/head';\r\nimport Link from 'next/link';\r\nimport { useRouter } from 'next/router';\r\nimport { useState, useEffect, useCallback } from 'react';\r\nimport BookingAuthModal from '@/components/BookingAuthModal';\r\nimport { useAuth } from '@/context/AuthContext';\r\n\r\ninterface TimeSlot {\r\n  start_time: string;\r\n  formatedTime: string;\r\n  slots: number;\r\n}\r\n\r\ninterface Availability {\r\n  date: string;\r\n  available: boolean;\r\n  spots: TimeSlot[];\r\n}\r\n\r\nconst BookAPiercing = () => {\r\n  const router = useRouter();\r\n  const { location, reschedule } = router.query;\r\n  const { isAuthenticated, user, loading: authLoading } = useAuth();\r\n  const rescheduleBookingId = reschedule as string | undefined;\r\n  const isRescheduleMode = !!rescheduleBookingId;\r\n  const [showAuthModal, setShowAuthModal] = useState(false);\r\n  const [isClient, setIsClient] = useState(false);\r\n  const [attemptedDate, setAttemptedDate] = useState<string | null>(null);\r\n  const [selectedDate, setSelectedDate] = useState<string | null>(null);\r\n  const [selectedTime, setSelectedTime] = useState<string | null>(null);\r\n  const [availableTimes, setAvailableTimes] = useState<TimeSlot[]>([]);\r\n  const [availabilities, setAvailabilities] = useState<Availability[]>([]);\r\n  const [agreeToTos, setAgreeToTos] = useState(false);\r\n  const [loading, setLoading] = useState(true);\r\n  const [isBooked, setIsBooked] = useState(false);\r\n  const [bookedTime, setBookedTime] = useState<string | null>(null);\r\n  const [isLoading, setIsLoading] = useState(false);\r\n  const [currentMonth, setCurrentMonth] = useState<Date | null>(null);\r\n\r\n  // Initialize on client side only to prevent hydration issues\r\n  useEffect(() => {\r\n    setIsClient(true);\r\n  }, []);\r\n\r\n  // Initialize currentMonth on client side only\r\n  useEffect(() => {\r\n    if (currentMonth === null && isClient) {\r\n      setCurrentMonth(new Date());\r\n    }\r\n  }, [isClient, currentMonth]);\r\n\r\n  const locationTitle = location === 'chesterfield' \r\n    ? 'Chesterfield' \r\n    : location === 'leicester' \r\n    ? 'Leicester' \r\n    : 'Booking';\r\n\r\n  const locationMap = {\r\n    chesterfield: { \r\n      name: 'Chester',\r\n      address: '3 Knifesmithgate', \r\n      city: 'Chesterfield', \r\n      postcode: 'S40 1RF', \r\n      phone: '+44 (0) 1246 555555' \r\n    },\r\n    leicester: { \r\n      name: 'Leicester',\r\n      address: '8 Silver Walk, St Martins Square', \r\n      city: 'Leicester', \r\n      postcode: 'LE1 5EW', \r\n      phone: '+44 (0) 116 507 0400' \r\n    }\r\n  };\r\n\r\n  const locationData = location ? locationMap[location as keyof typeof locationMap] : null;\r\n\r\n  // Mock data - replace with API call\r\n  const generateMockAvailabilities = () => {\r\n    const availabilities: Availability[] = [];\r\n    const today = new Date();\r\n    \r\n    for (let i = 0; i < 30; i++) {\r\n      const date = new Date(today);\r\n      date.setDate(date.getDate() + i);\r\n      if (date.getDay() === 0) continue; // Skip Sundays\r\n      \r\n      const dateStr = date.toISOString().split('T')[0];\r\n      const timeSlots: TimeSlot[] = [\r\n        { start_time: '09:00 AM', formatedTime: '9:00 AM', slots: 2 },\r\n        { start_time: '10:00 AM', formatedTime: '10:00 AM', slots: 2 },\r\n        { start_time: '11:00 AM', formatedTime: '11:00 AM', slots: i % 2 === 0 ? 1 : 2 },\r\n        { start_time: '02:00 PM', formatedTime: '2:00 PM', slots: 2 },\r\n        { start_time: '03:00 PM', formatedTime: '3:00 PM', slots: 2 },\r\n        { start_time: '04:00 PM', formatedTime: '4:00 PM', slots: i % 3 === 0 ? 0 : 1 },\r\n      ];\r\n      \r\n      availabilities.push({\r\n        date: dateStr,\r\n        available: timeSlots.some(t => t.slots > 0),\r\n        spots: timeSlots\r\n      });\r\n    }\r\n    \r\n    return availabilities;\r\n  };\r\n\r\n  const handleAuthSuccess = useCallback(() => {\r\n    // After successful authentication, auto-select the date they tried to click\r\n    if (attemptedDate) {\r\n      setSelectedDate(attemptedDate);\r\n      setAttemptedDate(null);\r\n    }\r\n  }, [attemptedDate]);\r\n\r\n  // Initialize availabilities from API on mount\r\n  useEffect(() => {\r\n    const fetchAvailabilities = async () => {\r\n      if (!location) return;\r\n      try {\r\n        const response = await fetch(`/api/booking/availability?location=${location}`);\r\n        if (response.ok) {\r\n          const data = await response.json();\r\n          setAvailabilities(data.availabilities || []);\r\n        } else {\r\n          console.error('Failed to fetch availabilities');\r\n          // Fallback to mock data\r\n          setAvailabilities(generateMockAvailabilities());\r\n        }\r\n      } catch (error) {\r\n        console.error('Error fetching availabilities:', error);\r\n        // Fallback to mock data\r\n        setAvailabilities(generateMockAvailabilities());\r\n      } finally {\r\n        setLoading(false);\r\n      }\r\n    };\r\n\r\n    fetchAvailabilities();\r\n  }, [location]);\r\n\r\n  // Update available times when date is selected\r\n  useEffect(() => {\r\n    if (selectedDate) {\r\n      const availability = availabilities.find((a) => a.date === selectedDate);\r\n      if (availability) {\r\n        setAvailableTimes(availability.spots.filter((t) => t.slots > 0));\r\n        setSelectedTime(null);\r\n      }\r\n    }\r\n  }, [selectedDate, availabilities]);\r\n\r\n  // Auto-select the attempted date after successful authentication\r\n  useEffect(() => {\r\n    if (isClient && isAuthenticated && user?.id && attemptedDate) {\r\n      handleAuthSuccess();\r\n    }\r\n  }, [isClient, isAuthenticated, user?.id, attemptedDate, handleAuthSuccess]);\r\n\r\n  const getDaysInMonth = (date: Date) => {\r\n    return new Date(date.getFullYear(), date.getMonth() + 1, 0).getDate();\r\n  };\r\n\r\n  const getFirstDayOfMonth = (date: Date) => {\r\n    return new Date(date.getFullYear(), date.getMonth(), 1).getDay();\r\n  };\r\n\r\n  const renderCalendar = () => {\r\n    if (!currentMonth) return [];\r\n    const daysInMonth = getDaysInMonth(currentMonth);\r\n    const firstDay = getFirstDayOfMonth(currentMonth);\r\n    const days: JSX.Element[] = [];\r\n    const today = new Date();\r\n    const todayDate = today.getDate();\r\n    const currentMonthNum = today.getMonth();\r\n    const currentYear = today.getFullYear();\r\n\r\n    // Empty cells for days before the first day of month\r\n    for (let i = 0; i < firstDay; i++) {\r\n      days.push(<div key={`empty-${i}`}></div>);\r\n    }\r\n\r\n    // Days of the month\r\n    for (let day = 1; day <= daysInMonth; day++) {\r\n      const date = new Date(currentMonth.getFullYear(), currentMonth.getMonth(), day);\r\n      const dateStr = date.toISOString().split('T')[0];\r\n      const availability = availabilities.find((a) => a.date === dateStr);\r\n      const isToday = (day === todayDate && \r\n                       currentMonth.getMonth() === currentMonthNum && \r\n                       currentMonth.getFullYear() === currentYear);\r\n      const isPastDate = date < today;\r\n      const isSunday = date.getDay() === 0;\r\n      const isSelected = selectedDate === dateStr;\r\n      const hasAvailability = availability && availability.available && !isPastDate && !isSunday;\r\n\r\n      days.push(\r\n        <button\r\n          key={dateStr}\r\n          onClick={() => !authLoading && hasAvailability && handleDateClick(dateStr)}\r\n          disabled={!hasAvailability || authLoading}\r\n          style={{\r\n            padding: '12px',\r\n            fontSize: '14px',\r\n            fontWeight: isToday ? '700' : '500',\r\n            border: isSelected ? 'none' : '1px solid #ddd',\r\n            borderRadius: '4px',\r\n            background: isSelected \r\n              ? '#000'\r\n              : isToday\r\n              ? '#f0f0f0'\r\n              : '#fff',\r\n            color: isSelected ? '#fff' : '#000',\r\n            cursor: (hasAvailability && !authLoading) ? 'pointer' : 'not-allowed',\r\n            opacity: (!hasAvailability || authLoading) ? 0.5 : 1,\r\n            transition: 'all 0.2s'\r\n          }}\r\n        >\r\n          {day}\r\n        </button>\r\n      );\r\n    }\r\n\r\n    return days;\r\n  };\r\n\r\n  const handleDateClick = (dateStr: string) => {\r\n    // Wait for auth to load, then check if user is authenticated\r\n    if (!isClient || authLoading) {\r\n      return;\r\n    }\r\n    \r\n    // Check if user is authenticated AND has user data\r\n    const isReallyAuthenticated = isAuthenticated && !!user?.id;\r\n    \r\n    if (!isReallyAuthenticated) {\r\n      // Store the date they tried to click and show auth modal\r\n      setAttemptedDate(dateStr);\r\n      setShowAuthModal(true);\r\n      return;\r\n    }\r\n    // User is authenticated, select the date\r\n    setSelectedDate(dateStr);\r\n  };\r\n\r\n  const formatBookingTime = (dateStr: string, timeStr: string) => {\r\n    const date = new Date(dateStr + 'T00:00:00');\r\n    const [time, period] = timeStr.split(' ');\r\n    const [hours, mins] = time.split(':').map(Number);\r\n    \r\n    const adjustedHours = period === 'PM' && hours !== 12 ? hours + 12 : (period === 'AM' && hours === 12 ? 0 : hours);\r\n    date.setHours(adjustedHours, mins);\r\n    \r\n    const day = date.getDate();\r\n    const month = date.getMonth() + 1;\r\n    const year = date.getFullYear();\r\n    \r\n    const dateFormatted = `${day}/${month}/${year}`;\r\n    return `${dateFormatted} ${timeStr}`;\r\n  };\r\n\r\n  const handleConfirmBooking = async () => {\r\n    if (!selectedDate || !selectedTime || !agreeToTos) {\r\n      alert('Please select a date, time, and accept terms & conditions');\r\n      return;\r\n    }\r\n\r\n    if (!user?.id) {\r\n      alert('You must be logged in to confirm a booking');\r\n      return;\r\n    }\r\n    \r\n    setIsLoading(true);\r\n    \r\n    try {\r\n      // Determine which endpoint to use based on mode\r\n      const endpoint = isRescheduleMode ? '/api/booking/reschedule' : '/api/booking/confirm';\r\n      const payload = isRescheduleMode \r\n        ? {\r\n            bookingId: rescheduleBookingId,\r\n            location,\r\n            date: selectedDate,\r\n            time: selectedTime,\r\n          }\r\n        : {\r\n            location,\r\n            date: selectedDate,\r\n            time: selectedTime,\r\n            email: user.email || '',\r\n            firstName: user.firstName || 'Guest',\r\n            lastName: user.lastName || '',\r\n            customerId: user.id,\r\n          };\r\n\r\n      const response = await fetch(endpoint, {\r\n        method: 'POST',\r\n        headers: {\r\n          'Content-Type': 'application/json',\r\n        },\r\n        body: JSON.stringify(payload),\r\n      });\r\n\r\n      const data = await response.json();\r\n\r\n      if (response.ok) {\r\n        if (isRescheduleMode) {\r\n          // Reschedule successful - redirect to account page\r\n          alert('Appointment rescheduled successfully');\r\n          router.push('/account');\r\n        } else {\r\n          // New booking - redirect to checkout\r\n          if (data.checkoutUrl) {\r\n            window.location.href = data.checkoutUrl;\r\n          } else {\r\n            alert(`Booking confirmed for ${formatBookingTime(selectedDate, selectedTime)}`);\r\n            setIsBooked(true);\r\n            setBookedTime(formatBookingTime(selectedDate, selectedTime));\r\n            setSelectedDate(null);\r\n            setSelectedTime(null);\r\n            setAgreeToTos(false);\r\n          }\r\n        }\r\n      } else {\r\n        const errorDetails = data.details ? ` (${data.details})` : '';\r\n        alert(`${isRescheduleMode ? 'Reschedule' : 'Booking'} failed: ${data.error}${errorDetails}`);\r\n      }\r\n    } catch (error) {\r\n      console.error('Booking error:', error);\r\n      alert('Error confirming booking. Please try again.');\r\n    } finally {\r\n      setIsLoading(false);\r\n    }\r\n  };\r\n\r\n  const monthNames = ['January', 'February', 'March', 'April', 'May', 'June',\r\n    'July', 'August', 'September', 'October', 'November', 'December'];\r\n  const dayNames = ['Sun', 'Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat'];\r\n\r\n  if (loading) {\r\n    return (\r\n      <main style={{ maxWidth: '1200px', margin: '0 auto', padding: '40px 24px' }}>\r\n        <Head>\r\n          <title>{`Book a Piercing - ${locationTitle} | Pierce of Art`}</title>\r\n        </Head>\r\n        <div style={{ textAlign: 'center', padding: '40px' }}>Loading availability...</div>\r\n      </main>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <>\r\n      <Head>\r\n        <title>{`Book a Piercing - ${locationTitle} | Pierce of Art`}</title>\r\n        <meta name=\"description\" content={`Book your piercing appointment at Pierce of Art ${locationTitle}`} />\r\n      </Head>\r\n\r\n      <BookingAuthModal\r\n        isOpen={showAuthModal}\r\n        onClose={() => setShowAuthModal(false)}\r\n        onAuthSuccess={handleAuthSuccess}\r\n      />\r\n\r\n      <main style={{ maxWidth: '1200px', margin: '0 auto', padding: '40px 24px' }}>\r\n        <div style={{ textAlign: 'left', marginBottom: '40px' }}>\r\n          <h1 style={{ fontSize: '32px', fontWeight: '700', marginBottom: '8px', textTransform: 'uppercase' }}>\r\n            {isRescheduleMode ? 'RESCHEDULE APPOINTMENT' : isBooked ? 'RE-SCHEDULE' : 'PRIORITY BOOKING'}\r\n          </h1>\r\n          <h3 style={{ fontSize: '24px', fontWeight: '600' }}>\r\n            {locationTitle}\r\n          </h3>\r\n        </div>\r\n\r\n        {isRescheduleMode && (\r\n          <div style={{\r\n            background: '#e8f4f8',\r\n            padding: '20px 24px',\r\n            marginBottom: '32px',\r\n            borderRadius: '4px',\r\n            borderLeft: '4px solid #03cb91'\r\n          }}>\r\n            <p style={{ margin: '0' }}>\r\n              <strong>Select a new date and time for your appointment.</strong> No checkout required - your appointment will be updated immediately.\r\n            </p>\r\n          </div>\r\n        )}\r\n\r\n        {isBooked && !isRescheduleMode && (\r\n          <div style={{\r\n            background: '#f0f0f0',\r\n            padding: '20px 24px',\r\n            marginBottom: '32px',\r\n            borderRadius: '4px'\r\n          }}>\r\n            <p style={{ margin: '0 0 8px 0' }}>\r\n              <strong>You&apos;ve already got a piercing booked for {bookedTime}</strong>\r\n            </p>\r\n            <p style={{ margin: '0 0 8px 0' }}>Don&apos;t worry though. You can have more than 1 piercing when you arrive.</p>\r\n            <p style={{ margin: 0 }}>If you&apos;re trying to book for a friend, they will need to book separately.</p>\r\n          </div>\r\n        )}\r\n\r\n        {!isBooked && (\r\n          <div style={{\r\n            background: '#f9f9f9',\r\n            padding: '40px 24px',\r\n            borderRadius: '8px'\r\n          }}>\r\n            {/* Calendar Section */}\r\n            {currentMonth && (\r\n            <div style={{ marginBottom: '40px' }}>\r\n              <label style={{ display: 'block', fontSize: '14px', fontWeight: '600', marginBottom: '20px', textTransform: 'uppercase' }}>\r\n                SELECT DATE\r\n              </label>\r\n\r\n              <div style={{\r\n                background: '#fff',\r\n                padding: '24px',\r\n                borderRadius: '4px',\r\n                border: '1px solid #ddd'\r\n              }}>\r\n                {/* Month Navigation */}\r\n                <div style={{\r\n                  display: 'flex',\r\n                  justifyContent: 'space-between',\r\n                  alignItems: 'center',\r\n                  marginBottom: '24px'\r\n                }}>\r\n                  <button\r\n                    onClick={() => currentMonth && setCurrentMonth(new Date(currentMonth.getFullYear(), currentMonth.getMonth() - 1))}\r\n                    style={{\r\n                      background: 'none',\r\n                      border: 'none',\r\n                      fontSize: '18px',\r\n                      cursor: 'pointer',\r\n                      color: '#03cb91'\r\n                    }}\r\n                  >\r\n                    ← Prev\r\n                  </button>\r\n                  <h3 style={{ fontSize: '18px', fontWeight: '600', margin: 0 }}>\r\n                    {monthNames[currentMonth.getMonth()]} {currentMonth.getFullYear()}\r\n                  </h3>\r\n                  <button\r\n                    onClick={() => currentMonth && setCurrentMonth(new Date(currentMonth.getFullYear(), currentMonth.getMonth() + 1))}\r\n                    style={{\r\n                      background: 'none',\r\n                      border: 'none',\r\n                      fontSize: '18px',\r\n                      cursor: 'pointer',\r\n                      color: '#03cb91'\r\n                    }}\r\n                  >\r\n                    Next →\r\n                  </button>\r\n                </div>\r\n\r\n                {/* Day Headers */}\r\n                <div style={{\r\n                  display: 'grid',\r\n                  gridTemplateColumns: 'repeat(7, 1fr)',\r\n                  gap: '8px',\r\n                  marginBottom: '12px'\r\n                }}>\r\n                  {dayNames.map((day) => (\r\n                    <div\r\n                      key={day}\r\n                      style={{\r\n                        textAlign: 'center',\r\n                        fontWeight: '600',\r\n                        fontSize: '12px',\r\n                        padding: '8px',\r\n                        color: '#666'\r\n                      }}\r\n                    >\r\n                      {day}\r\n                    </div>\r\n                  ))}\r\n                </div>\r\n\r\n                {/* Calendar Days */}\r\n                <div style={{\r\n                  display: 'grid',\r\n                  gridTemplateColumns: 'repeat(7, 1fr)',\r\n                  gap: '8px'\r\n                }}>\r\n                  {renderCalendar()}\r\n                </div>\r\n              </div>\r\n            </div>\r\n            )}\r\n\r\n            {/* Time Picker Section */}\r\n            {selectedDate && (\r\n              <div style={{ marginBottom: '40px' }}>\r\n                <label style={{ display: 'block', fontSize: '14px', fontWeight: '600', marginBottom: '20px', textTransform: 'uppercase' }}>\r\n                  SELECT TIME\r\n                </label>\r\n                <div style={{\r\n                  display: 'grid',\r\n                  gridTemplateColumns: 'repeat(auto-fit, minmax(140px, 1fr))',\r\n                  gap: '12px'\r\n                }}>\r\n                  {availableTimes.length > 0 ? (\r\n                    availableTimes.map((time) => (\r\n                      <button\r\n                        key={time.start_time}\r\n                        onClick={() => setSelectedTime(time.start_time)}\r\n                        style={{\r\n                          padding: '16px 12px',\r\n                          fontSize: '14px',\r\n                          fontWeight: '600',\r\n                          border: selectedTime === time.start_time ? 'none' : '1px solid #ddd',\r\n                          borderRadius: '4px',\r\n                          background: selectedTime === time.start_time \r\n                            ? '#000'\r\n                            : '#fff',\r\n                          color: selectedTime === time.start_time ? '#fff' : '#000',\r\n                          cursor: 'pointer',\r\n                          transition: 'all 0.2s'\r\n                        }}\r\n                      >\r\n                        <div>{time.formatedTime}</div>\r\n                        <div style={{ fontSize: '12px', marginTop: '4px', opacity: 0.8 }}>\r\n                          {time.slots} slot{time.slots > 1 ? 's' : ''}\r\n                        </div>\r\n                      </button>\r\n                    ))\r\n                  ) : (\r\n                    <div style={{ padding: '20px', color: '#999', gridColumn: '1 / -1' }}>\r\n                      No available times for this date\r\n                    </div>\r\n                  )}\r\n                </div>\r\n              </div>\r\n            )}\r\n\r\n            {/* Terms & Conditions */}\r\n            {selectedTime && (\r\n              <div style={{ marginBottom: '24px' }}>\r\n                <label style={{ display: 'flex', alignItems: 'center', gap: '12px', cursor: 'pointer' }}>\r\n                  <input\r\n                    type=\"checkbox\"\r\n                    checked={agreeToTos}\r\n                    onChange={(e) => setAgreeToTos(e.target.checked)}\r\n                    style={{ cursor: 'pointer', width: '20px', height: '20px' }}\r\n                  />\r\n                  <span style={{ fontSize: '14px' }}>\r\n                    I agree to the <Link href=\"/information/terms-of-service\" style={{ color: '#000', textDecoration: 'underline' }}>terms &amp; conditions</Link>\r\n                  </span>\r\n                </label>\r\n              </div>\r\n            )}\r\n\r\n            {/* Location Info */}\r\n            <div style={{\r\n              marginTop: '40px',\r\n              padding: '24px',\r\n              background: '#fff',\r\n              borderRadius: '4px'\r\n            }}>\r\n              <h3 style={{ fontSize: '16px', fontWeight: '600', marginBottom: '12px' }}>\r\n                {locationTitle} Location\r\n              </h3>\r\n              <p style={{ fontSize: '14px', color: '#666', lineHeight: '1.6', margin: 0 }}>\r\n                {locationData?.address}<br />\r\n                {locationData?.city}<br />\r\n                {locationData?.postcode}<br />\r\n                <br />\r\n                <strong>Phone:</strong> <a href={`tel:${locationData?.phone.replace(/\\s/g, '')}`} style={{ color: '#000' }}>{locationData?.phone}</a>\r\n              </p>\r\n            </div>\r\n          </div>\r\n        )}\r\n\r\n        {/* Confirm Button */}\r\n        {selectedTime && (\r\n          <div style={{\r\n            position: 'fixed',\r\n            bottom: 0,\r\n            left: 0,\r\n            right: 0,\r\n            background: '#181818',\r\n            padding: '16px 24px',\r\n            display: 'flex',\r\n            flexDirection: 'column',\r\n            gap: '12px',\r\n            zIndex: 100\r\n          }}>\r\n            <div style={{\r\n              background: '#fff',\r\n              color: '#000',\r\n              padding: '12px',\r\n              textAlign: 'center',\r\n              fontSize: '16px',\r\n              fontWeight: '600',\r\n              borderRadius: '0'\r\n            }}>\r\n              MY BOOKING: {new Date(selectedDate + 'T00:00:00').toLocaleDateString()} {selectedTime}\r\n            </div>\r\n            <button\r\n              onClick={handleConfirmBooking}\r\n              disabled={!agreeToTos || isLoading}\r\n              style={{\r\n                padding: '16px 24px',\r\n                fontSize: '16px',\r\n                fontWeight: '700',\r\n                background: agreeToTos ? '#000' : '#ccc',\r\n                color: '#fff',\r\n                border: 'none',\r\n                borderRadius: '0',\r\n                cursor: agreeToTos ? 'pointer' : 'not-allowed',\r\n                textTransform: 'uppercase',\r\n                width: '100%',\r\n                opacity: isLoading ? 0.7 : 1\r\n              }}\r\n              title=\"You must agree to terms & conditions to proceed\"\r\n            >\r\n              {isLoading ? 'Processing...' : 'Confirm Booking & Proceed to Checkout (Terms Accepted)'}\r\n            </button>\r\n          </div>\r\n        )}\r\n      </main>\r\n    </>\r\n  );\r\n};\r\n\r\nexport default BookAPiercing;"],"names":[],"mappings":"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"}},
    {"offset": {"line": 2234, "column": 0}, "map": {"version":3,"sources":["turbopack:///[next]/entry/page-loader.ts"],"sourcesContent":["const PAGE_PATH = \"/book-a-piercing/[location]\";\n\n/// <reference types=\"next/client\" />\r\n\r\n// inserted by rust code\r\ndeclare const PAGE_PATH: string\r\n\r\n  // Adapted from https://github.com/vercel/next.js/blob/b7f9f1f98fc8ab602e84825105b5727272b72e7d/packages/next/src/build/webpack/loaders/next-client-pages-loader.ts\r\n;(window.__NEXT_P = window.__NEXT_P || []).push([\r\n  PAGE_PATH,\r\n  () => {\r\n    return require('PAGE')\r\n  },\r\n])\r\n// @ts-expect-error module.hot exists\r\nif (module.hot) {\r\n  // @ts-expect-error module.hot exists\r\n  module.hot.dispose(function () {\r\n    window.__NEXT_P.push([PAGE_PATH])\r\n  })\r\n}\r\n"],"names":[],"mappings":"AAAA,MAAM,YAAY;AAQjB,CAAC,OAAO,QAAQ,GAAG,OAAO,QAAQ,IAAI,EAAE,EAAE,IAAI,CAAC;IAC9C;IACA;QACE;IACF;CACD;AACD,qCAAqC;AACrC,IAAI,OAAO,GAAG,EAAE;IACd,qCAAqC;IACrC,OAAO,GAAG,CAAC,OAAO,CAAC;QACjB,OAAO,QAAQ,CAAC,IAAI,CAAC;YAAC;SAAU;IAClC;AACF","ignoreList":[0]}}]
}